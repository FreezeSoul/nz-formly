{"version":3,"file":"freezesoul-nz-formly-text-value.mjs","sources":["../../../lib/text-value/text-value.component.ts","../../../lib/text-value/text-value.module.ts","../../../lib/text-value/freezesoul-nz-formly-text-value.ts"],"sourcesContent":["import { ChangeDetectionStrategy, Component, OnDestroy, OnInit } from '@angular/core';\r\nimport { FieldType } from '@ngx-formly/core';\r\nimport { NzxUtils } from '@freezesoul/nzx-antd/util';\r\nimport { Observable, of, Subscription } from 'rxjs';\r\nimport { TextFieldConfig } from './formly.type';\r\n\r\n@Component({\r\n  selector: 'nz-formly-text-value',\r\n  template: `\r\n    <nz-form-text class=\"wrap-text\" [formlyAttributes]=\"field\" [ngClass]=\"props.ngClass\" [ngStyle]=\"props.ngStyle\">\r\n      {{ textValue | async | defaultify: props.defaultText }}\r\n    </nz-form-text>\r\n  `,\r\n  styles: [\r\n    `\r\n      .wrap-text {\r\n        word-break: break-all;\r\n      }\r\n    `\r\n  ],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class FormlyFieldTextValueComponent<T> extends FieldType<TextFieldConfig> implements OnInit, OnDestroy {\r\n  private result?: Observable<T> | Promise<T>;\r\n  private subscription?: Subscription;\r\n\r\n  override defaultOptions = {\r\n    props: {\r\n      defaultText: '--'\r\n    }\r\n  };\r\n\r\n  ngOnInit(): void {\r\n    this.subscription = this.formControl!.valueChanges.subscribe(value => {\r\n      this.result = undefined;\r\n    });\r\n  }\r\n\r\n  get textValue() {\r\n    const value = this.formControl!.value;\r\n    const format = this.props.format || this.formState.format;\r\n\r\n    if (typeof format !== 'function') {\r\n      return of(value);\r\n    }\r\n\r\n    if (this.result) {\r\n      return this.result;\r\n    }\r\n    const result = format(value, this.field);\r\n    if (NzxUtils.isPromise(result) || NzxUtils.isObservable(result)) {\r\n      this.result = result;\r\n      return result;\r\n    }\r\n    return of(result);\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    this.subscription?.unsubscribe();\r\n  }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormlyFieldTextValueComponent } from './text-value.component';\r\nimport { FormlyModule } from '@ngx-formly/core';\r\nimport { NzxPipeModule } from '@freezesoul/nzx-antd/pipe';\r\nimport { NzFormModule } from 'ng-zorro-antd/form';\r\n\r\nconst COMPONENT = FormlyFieldTextValueComponent;\r\n\r\n@NgModule({\r\n  declarations: [COMPONENT],\r\n  imports: [\r\n    CommonModule,\r\n    NzxPipeModule,\r\n    NzFormModule,\r\n    FormlyModule.forChild({\r\n      types: [\r\n        {\r\n          name: 'text',\r\n          component: COMPONENT,\r\n          wrappers: ['field-wrapper']\r\n        }\r\n      ]\r\n    })\r\n  ]\r\n})\r\nexport class FormlyNzTextValueModule {}\r\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public_api';\n"],"names":["i1"],"mappings":";;;;;;;;;;;;;AAsBM,MAAO,6BAAiC,SAAQ,SAA0B,CAAA;AACtE,IAAA,MAAM,CAA8B;AACpC,IAAA,YAAY,CAAgB;AAE3B,IAAA,cAAc,GAAG;AACxB,QAAA,KAAK,EAAE;AACL,YAAA,WAAW,EAAE,IAAI;AAClB,SAAA;KACF,CAAC;IAEF,QAAQ,GAAA;AACN,QAAA,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,WAAY,CAAC,YAAY,CAAC,SAAS,CAAC,KAAK,IAAG;AACnE,YAAA,IAAI,CAAC,MAAM,GAAG,SAAS,CAAC;AAC1B,SAAC,CAAC,CAAC;KACJ;AAED,IAAA,IAAI,SAAS,GAAA;AACX,QAAA,MAAM,KAAK,GAAG,IAAI,CAAC,WAAY,CAAC,KAAK,CAAC;AACtC,QAAA,MAAM,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,IAAI,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC;AAE1D,QAAA,IAAI,OAAO,MAAM,KAAK,UAAU,EAAE;AAChC,YAAA,OAAO,EAAE,CAAC,KAAK,CAAC,CAAC;AAClB,SAAA;QAED,IAAI,IAAI,CAAC,MAAM,EAAE;YACf,OAAO,IAAI,CAAC,MAAM,CAAC;AACpB,SAAA;QACD,MAAM,MAAM,GAAG,MAAM,CAAC,KAAK,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC;AACzC,QAAA,IAAI,QAAQ,CAAC,SAAS,CAAC,MAAM,CAAC,IAAI,QAAQ,CAAC,YAAY,CAAC,MAAM,CAAC,EAAE;AAC/D,YAAA,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;AACrB,YAAA,OAAO,MAAM,CAAC;AACf,SAAA;AACD,QAAA,OAAO,EAAE,CAAC,MAAM,CAAC,CAAC;KACnB;IAED,WAAW,GAAA;AACT,QAAA,IAAI,CAAC,YAAY,EAAE,WAAW,EAAE,CAAC;KAClC;wGArCU,6BAA6B,EAAA,IAAA,EAAA,IAAA,EAAA,MAAA,EAAA,EAAA,CAAA,eAAA,CAAA,SAAA,EAAA,CAAA,CAAA;AAA7B,IAAA,OAAA,IAAA,GAAA,EAAA,CAAA,oBAAA,CAAA,EAAA,UAAA,EAAA,QAAA,EAAA,OAAA,EAAA,SAAA,EAAA,IAAA,EAAA,6BAA6B,EAd9B,QAAA,EAAA,sBAAA,EAAA,eAAA,EAAA,IAAA,EAAA,QAAA,EAAA,EAAA,EAAA,QAAA,EAAA,CAAA;;;;AAIT,EAAA,CAAA,EAAA,QAAA,EAAA,IAAA,EAAA,MAAA,EAAA,CAAA,oCAAA,CAAA,EAAA,YAAA,EAAA,CAAA,EAAA,IAAA,EAAA,WAAA,EAAA,IAAA,EAAA,EAAA,CAAA,OAAA,EAAA,QAAA,EAAA,WAAA,EAAA,MAAA,EAAA,CAAA,OAAA,EAAA,SAAA,CAAA,EAAA,EAAA,EAAA,IAAA,EAAA,WAAA,EAAA,IAAA,EAAA,EAAA,CAAA,OAAA,EAAA,QAAA,EAAA,WAAA,EAAA,MAAA,EAAA,CAAA,SAAA,CAAA,EAAA,EAAA,EAAA,IAAA,EAAA,WAAA,EAAA,IAAA,EAAA,EAAA,CAAA,mBAAA,EAAA,QAAA,EAAA,cAAA,EAAA,QAAA,EAAA,CAAA,YAAA,CAAA,EAAA,EAAA,EAAA,IAAA,EAAA,WAAA,EAAA,IAAA,EAAA,EAAA,CAAA,iBAAA,EAAA,QAAA,EAAA,oBAAA,EAAA,MAAA,EAAA,CAAA,kBAAA,EAAA,IAAA,CAAA,EAAA,EAAA,EAAA,IAAA,EAAA,MAAA,EAAA,IAAA,EAAA,EAAA,CAAA,SAAA,EAAA,IAAA,EAAA,OAAA,EAAA,EAAA,EAAA,IAAA,EAAA,MAAA,EAAA,IAAA,EAAA,EAAA,CAAA,cAAA,EAAA,IAAA,EAAA,YAAA,EAAA,CAAA,EAAA,eAAA,EAAA,EAAA,CAAA,uBAAA,CAAA,MAAA,EAAA,CAAA,CAAA;;4FAUU,6BAA6B,EAAA,UAAA,EAAA,CAAA;kBAhBzC,SAAS;AACE,YAAA,IAAA,EAAA,CAAA,EAAA,QAAA,EAAA,sBAAsB,EACtB,QAAA,EAAA,CAAA;;;;GAIT,EAQgB,eAAA,EAAA,uBAAuB,CAAC,MAAM,EAAA,MAAA,EAAA,CAAA,oCAAA,CAAA,EAAA,CAAA;;;ACbjD,MAAM,SAAS,GAAG,6BAA6B,CAAC;MAmBnC,uBAAuB,CAAA;wGAAvB,uBAAuB,EAAA,IAAA,EAAA,EAAA,EAAA,MAAA,EAAA,EAAA,CAAA,eAAA,CAAA,QAAA,EAAA,CAAA,CAAA;yGAAvB,uBAAuB,EAAA,YAAA,EAAA,CAnBlB,6BAA6B,CAAA,EAAA,OAAA,EAAA,CAK3C,YAAY;YACZ,aAAa;YACb,YAAY,EAAAA,EAAA,CAAA,YAAA,CAAA,EAAA,CAAA,CAAA;AAYH,IAAA,OAAA,IAAA,GAAA,EAAA,CAAA,mBAAA,CAAA,EAAA,UAAA,EAAA,QAAA,EAAA,OAAA,EAAA,SAAA,EAAA,QAAA,EAAA,EAAA,EAAA,IAAA,EAAA,uBAAuB,YAdhC,YAAY;YACZ,aAAa;YACb,YAAY;YACZ,YAAY,CAAC,QAAQ,CAAC;AACpB,gBAAA,KAAK,EAAE;AACL,oBAAA;AACE,wBAAA,IAAI,EAAE,MAAM;AACZ,wBAAA,SAAS,EAAE,SAAS;wBACpB,QAAQ,EAAE,CAAC,eAAe,CAAC;AAC5B,qBAAA;AACF,iBAAA;aACF,CAAC,CAAA,EAAA,CAAA,CAAA;;4FAGO,uBAAuB,EAAA,UAAA,EAAA,CAAA;kBAjBnC,QAAQ;AAAC,YAAA,IAAA,EAAA,CAAA;oBACR,YAAY,EAAE,CAAC,SAAS,CAAC;AACzB,oBAAA,OAAO,EAAE;wBACP,YAAY;wBACZ,aAAa;wBACb,YAAY;wBACZ,YAAY,CAAC,QAAQ,CAAC;AACpB,4BAAA,KAAK,EAAE;AACL,gCAAA;AACE,oCAAA,IAAI,EAAE,MAAM;AACZ,oCAAA,SAAS,EAAE,SAAS;oCACpB,QAAQ,EAAE,CAAC,eAAe,CAAC;AAC5B,iCAAA;AACF,6BAAA;yBACF,CAAC;AACH,qBAAA;AACF,iBAAA,CAAA;;;ACzBD;;AAEG;;;;"}